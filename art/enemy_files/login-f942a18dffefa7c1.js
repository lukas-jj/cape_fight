!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ba5543b4-5e6b-4278-bf20-a5fba436d17e",e._sentryDebugIdIdentifier="sentry-dbid-ba5543b4-5e6b-4278-bf20-a5fba436d17e")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69344],{36407:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return r(36559)}])},53213:function(e,t,r){"use strict";var s=r(85893),i=r(22110),a=r(25675),n=r.n(a),o=r(11163),l=r(9529),c=r(74514),u=r(61647);t.Z=()=>{let{setDashboardRedirectAction:e}=(0,u.Z)(),t=(0,o.useRouter)();return(0,s.jsx)("div",{children:(0,s.jsxs)(i.z,{variant:"outline",className:"w-full flex items-center justify-center space-x-2",onClick:()=>{t.locale&&localStorage.setItem("locale",t.locale);let r=(0,c.P)("redirect");r&&e(JSON.stringify({type:u.t.redirect,url:r})),t.push("".concat("https://account.imageresizer.com","/auth/google"))},children:[(0,s.jsx)(n(),{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google logo",className:"w-5 h-5",width:16,height:16}),(0,s.jsx)("span",{children:(0,l.Iu)("continue-with-google")})]})})}},39164:function(e,t,r){"use strict";var s=r(85893);r(67294);var i=r(9529);t.Z=()=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("hr",{className:"w-full border-gray-300 dark:border-gray-600"}),(0,s.jsx)("span",{className:"px-2 text-sm text-gray-500",children:(0,i.Iu)("or")}),(0,s.jsx)("hr",{className:"w-full border-gray-300  dark:border-gray-600"})]})},645:function(e,t,r){"use strict";r.d(t,{w:function(){return o}});var s=r(85893),i=r(47804),a=r(44887),n=r(49476);let o=e=>{let{url:t,urlSlugVariables:r}=e;return(0,s.jsxs)("div",{className:"flex flex-row items-center h-16 px-4 py-4 border-b border-b-slate-200 dark:border-b-darkSurface-600 md:px-8",children:[(0,s.jsx)(i.K,{isEditor:!1}),(0,s.jsx)("div",{className:"mr-16"}),(0,s.jsx)(a.a,{isEditor:!1}),(0,s.jsx)("div",{className:"ml-auto lg:hidden",children:(0,s.jsx)(n.$,{url:t,urlSlugVariables:r,isEditor:!1})})]})}},97861:function(e,t,r){"use strict";r.d(t,{k:function(){return n}});var s=r(10777),i=r(28675),a=r(66347);function n(){let{isLoggedIn:e}=(0,a.Z)();return(0,s.a)({queryKey:["activeSubscriptionQuery"],enabled:e(),queryFn:async()=>i.B.getActiveSubscription()})}},61647:function(e,t,r){"use strict";r.d(t,{t:function(){return h},Z:function(){return f}});var s=r(28675),i=r(82886),a=r(66347),n=r(89018),o=r(67294),l=r(97861),c=r(50281),u=r(31955);let d=(e,t,r)=>{u.Z.set(e,t,{expires:(null==r?void 0:r.expires)||7,path:(null==r?void 0:r.path)||"/",secure:(null==r?void 0:r.secure)||!1})},p=e=>u.Z.get(e),g=e=>{u.Z.remove(e)};var v=r(11163),f=e=>{var t;let r=(0,v.useRouter)(),[u,f]=(0,o.useState)(!1),{isLoggedIn:m}=(0,a.Z)(),{toast:b}=(0,i.pm)(),{refetch:w,data:x,promise:y}=(0,l.k)(),S=!!(null==x?void 0:null===(t=x.result)||void 0===t?void 0:t.stripeSubscriptionId);function j(e){try{d("dashboardRedirectAction",(0,c.Ne)(e),{expires:new Date(Date.now()+18e4)})}catch(e){console.error(e)}}function I(){try{g("dashboardRedirectAction")}catch(e){console.error(e)}}let N=async()=>{try{let t=p("dashboardRedirectAction");if(t){let s=JSON.parse((0,c.Vy)(t));if(s.type===h.subscribe){var e;let t=await y;(null==t?void 0:null===(e=t.result)||void 0===e?void 0:e.stripeSubscriptionId)||k(s.planId)}else s.type===h.freeDowngrade||s.type===h.redirect&&s.url&&r.push(s.url);I()}}catch(e){console.error(e)}},k=async e=>{var t,i,a;if(!m()){let t=JSON.stringify({type:"subscribe",planId:e});j(t),r.push("".concat(n.n.signupRoute,"?redirectAction=").concat((0,c.Ne)(t)));return}if(!e){if(m()&&S&&(null==x?void 0:null===(t=x.result)||void 0===t?void 0:t.irSubscriptionStatus)=="active"){let e=JSON.stringify({type:h.freeDowngrade});r.push("".concat(n.n.dashboardRoute,"?redirectAction=").concat((0,c.Ne)(e)))}else r.push(n.n.dashboardRoute);return}if(S)return _({activeSubscriptionId:null==x?void 0:null===(i=x.result)||void 0===i?void 0:i.stripeSubscriptionId,isUpgrade:(null==x?void 0:null===(a=x.result)||void 0===a?void 0:a.status)==="active"});if(u)return;if(f(!0),!m()){window.location.href=n.n.loginRoute;return}let o=await s.B.createPaymentLink({planId:e});if(f(!1),I(),console.log(o),o.error){console.error(o.error),b({title:"Error",variant:"destructive",description:o.error.message});return}window.location.href=o.result.url,f(!1)},_=async e=>{let{activeSubscriptionId:t,isUpgrade:i}=e;if(!m()){r.push(n.n.loginRoute);return}if(!t){r.push(n.n.pricing);return}if(!u){f(!0);try{let e=await s.B.createCustomerPortalSession({activeSubscriptionId:i?t:void 0});if(f(!1),console.log(e),e.error){console.error(e.error);return}if(!e.result){b({title:"Error",variant:"destructive",description:"Unable to create customer portal session"});return}e.result.url&&r.push(e.result.url)}catch(e){console.error(e)}f(!1)}};return{handleSubscribeAction:k,isBusy:u,handleManageAction:_,activeSubscription:x,setDashboardRedirectAction:j,refreshSubscriptionIfNeeded:async()=>{var e,t;if(!m())return;let r=await y,i=null==r?void 0:null===(e=r.result)||void 0===e?void 0:e.stripeSubscriptionId;if(i&&(null==r?void 0:null===(t=r.result)||void 0===t?void 0:t.status)==="incomplete")try{await s.B.refreshSubscription(i)&&w()}catch(e){console.error(e)}},handleDashboardRedirectAction:N}};let h={subscribe:"subscribe",freeDowngrade:"freeDowngrade",redirect:"redirect"}},28675:function(e,t,r){"use strict";r.d(t,{B:function(){return l}});var s=r(9669),i=r.n(s);class a{static get baseUrlAccountServer(){return"https://account.imageresizer.com"}static get baseUrlBackendServer(){return"https://api.imageresizer.com"}}let n=i().create({baseURL:a.baseUrlAccountServer,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)});class o{}o.post=async(e,t,r)=>{let s=null,i=null;try{s=(await n.post(e,t,{headers:{...null!=r?r:{}}})).data}catch(e){var a,o,l,c,u,d,p;i={message:(null===(l=e.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:null===(a=o.message)||void 0===a?void 0:a.toString())||(null===(d=e.response)||void 0===d?void 0:null===(u=d.data)||void 0===u?void 0:null===(c=u.error)||void 0===c?void 0:c.toString())||e.message,code:e.code||"".concat(null===(p=e.response)||void 0===p?void 0:p.status)}}return{result:s,error:i}},o.get=async e=>{let t=null,r=null;try{t=(await n.get(e)).data}catch(e){var s,i;r={message:e.message,code:e.code||(null===(i=e.response)||void 0===i?void 0:null===(s=i.status)||void 0===s?void 0:s.toString())}}return{result:t,error:r}};class l{}l.createPaymentLink=async e=>await o.post("/stripe/create/payment-link",e),l.createCustomerPortalSession=async e=>{let{activeSubscriptionId:t}=e;return await o.post("/stripe/create/customer-portal-session",{activeSubscriptionId:t})},l.getCheckoutSession=async e=>await o.get("/stripe/checkout-session/".concat(e)),l.getActiveSubscription=async()=>await o.get("/subscription/current"),l.getAllSubscription=async()=>await o.get("/subscription/all"),l.refreshSubscription=async e=>await o.post("/subscription/refresh/".concat(e),{})},50281:function(e,t,r){"use strict";r.d(t,{Ne:function(){return i},Vy:function(){return a}});var s=r(48764).lW;let i=e=>s.from(e).toString("base64"),a=e=>s.from(e,"base64").toString("utf-8")},74514:function(e,t,r){"use strict";r.d(t,{P:function(){return s}});let s=e=>new URL(window.location.href).searchParams.get(e)},36559:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return A},default:function(){return R}});var s=r(85893),i=r(39164),a=r(645),n=r(87694),o=r(31804),l=r(53213),c=r(41664),u=r.n(c);r(67294);var d=r(9529),p=e=>{let{enableRecover:t=!0}=e;return(0,s.jsxs)("p",{className:"text-sm text-center text-gray-600",children:[(0,s.jsx)("span",{className:"dark:text-white",children:(0,d.Iu)("dont-have-an-account")}),(0,s.jsx)(u(),{href:"/pricing",className:"ml-1 text-indigo-500 hover:underline",children:(0,d.Iu)("signup")}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"dark:text-white",children:(0,d.Iu)("forgot-password")}),(0,s.jsx)(u(),{href:"/auth/forget",className:"ml-1 text-indigo-500 hover:underline",children:(0,d.Iu)("recover-password")})]})]})},g=r(71292),v=r(9489),f=r(98029),h=r(7727);let m=async e=>{try{return{data:(await h.Z.post("".concat("https://account.imageresizer.com","/auth/login"),e)).data,error:null}}catch(e){return{data:null,error:{messageKey:e.response.data.response.messageKey,message:e.response.data.response.message||e.message,data:e.response.data.response.data}}}};var b=r(87536),w=r(56312),x=r(66347),y=r(12940),S=r(82886),j=r(88733),I=r(40205),N=r(74514);let k=()=>{let{setToken:e,setUserEmail:t}=(0,x.Z)(),r=(0,y.R)(),{loginSchema:s}=(0,I.Z)(),{getValMsg:i}=(0,j.Z)(),{register:a,handleSubmit:n,setError:o,formState:{errors:l,isSubmitting:c}}=(0,b.cI)({resolver:(0,w.F)(s),mode:"onBlur"}),u=(0,f.D)({mutationFn:m,retry:1,onSuccess:s=>{if(s.error){var a,n;o("root",{message:s.error.message}),(0,S.Am)({title:i(s.error.messageKey,s.error.message).replace("durationInMin",Math.ceil(parseInt(null!==(n=null===(a=s.error.data)||void 0===a?void 0:a.remainingBlockDuration)&&void 0!==n?n:"0")/60)),variant:"destructive"});return}e(s.data.access_token),t(s.data.email);let l=(0,N.P)("redirect");l?r.replace(l):r.replace("/dashboard"),(0,S.Am)({title:i("login-success"),variant:"success"})}});return{register:a,handleSubmit:n,onSubmit:async e=>{u.mutate(e)},errors:l,pending:u.isPending||c}};var _=()=>{var e,t;let{register:r,handleSubmit:i,onSubmit:a,errors:n,pending:o}=k();return(0,s.jsxs)("form",{className:"space-y-4",onSubmit:i(a),children:[(0,s.jsx)(g.Z,{...r("email"),type:"text",title:(0,d.Iu)("email-field-title"),placeholder:(0,d.Iu)("email-field-title"),errorMsg:null===(e=n.email)||void 0===e?void 0:e.message,preventWhiteSpace:!0,"data-automation-id":"LoginFormEmail"}),(0,s.jsx)(g.Z,{...r("password"),type:"password",title:(0,d.Iu)("password-field-title"),placeholder:(0,d.Iu)("password-field-title"),errorMsg:null===(t=n.password)||void 0===t?void 0:t.message,"data-automation-id":"LoginFormPassword"}),(0,s.jsx)(v.Z,{pending:o,title:(0,d.Iu)("login-button-title")})]})},Z=r(58092);let P=()=>(0,s.jsxs)("div",{className:"w-full text-black max-w-1440 page-shadow dark:text-white min-h-screen flex flex-col",children:[(0,s.jsx)(a.w,{url:"/auth/login"}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"w-full max-w-[24rem] p-8 space-y-6 bg-white dark:bg-darkSurface-100 shadow-[0_0_30px_rgba(0,0,0,0.1)] rounded-lg",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-700 dark:text-white mb-4",children:(0,d.Iu)("page-title")}),(0,s.jsx)(Z.m,{children:(0,s.jsx)(_,{})}),(0,s.jsx)(i.Z,{}),(0,s.jsx)(l.Z,{}),(0,s.jsx)(p,{})]})})]});var A=!0,R=()=>(0,s.jsx)(o.i,{files:D,children:(0,s.jsx)(P,{})});let D=["login","auth",...n.y]}},function(e){e.O(0,[41664,28062,48764,464,87321,44887,57989,27412,92888,49774,40179],function(){return e(e.s=36407)}),_N_E=e.O()}]);
//# sourceMappingURL=login-f942a18dffefa7c1.js.map